# Yolov5  Deep Sort  Replicate

## Introduction

This repository contains a two-stage-tracker. The detections generated by YOLOv5, a family of object detection architectures and models pretrained on the COCO dataset, are passed to a Deep Sort algorithm, which tracks the objects. It can track any object that your Yolov5 model was trained to detect.

## 对于中文使用者的简单说明

先配好环境(建议虚拟环境).然后把自己想检测的视频找到,如下执行.

```bash
python3 track.py --source ...
```

如果需要txt格式的检测结果输出,按照如下可以保存到 `inference` .
txt格式按顺序显示的的数据含义是:
帧序号：当前帧的序号。 

对象ID：被跟踪对象的唯一标识符。 

边界框左上角的x坐标：对象边界框左上角的x坐标。 

边界框左上角的y坐标：对象边界框左上角的y坐标。 

边界框的宽度：对象边界框的宽度。 

边界框的高度：对象边界框的高度。 

值为-1意思是未识别的一些量,可以忽略.

```bash
python3 track.py --source ... --save-txt
```

如果需要json格式的检测结果输出,可以使用txt2json.py插件.
采用的json格式是:
{ 

	'video_name': *video_name*, 
 
	'frames': { 
 
		'frame_*frameId*': { 
  
			'cv_annotation': { 
   
				'*objType*_track_*trackId*': {
    
					'object_type': str, # e.g., 'car', 'pedestrian', etc. 
     
					'track_id': str, # e.g, 'track_3' 
     
					'bbox': [float, float, float, float], # e.g., [xtl, ytl, xbr, ybr] 
     
					'observed_frames': [int, int, int, ...], # e.g., [153, 154, 155, ...] 
     
				} 
    
			}
   
		}
  
	}
 
}


## Tracking sources

Tracking can be run on most video formats

```bash
$ python track.py --source 0  # webcam
                           img.jpg  # image
                           vid.mp4  # video
                           path/  # directory
                           path/*.jpg  # glob
                           'https://www.bilibili.com/video/BV19N4y1n7Tm)'  # Bilibili
                           'rtsp://example.com/media.mp4'  # RTSP, RTMP, HTTP stream
```


## Select a Yolov5 family model

There is a clear trade-off between model inference speed and accuracy. In order to make it possible to fulfill your inference speed/accuracy needs
you can select a Yolov5 family model for automatic download

```bash

$ python track.py --source 0 --yolo_weights yolov5n.pt --img 640
                                            yolov5s.pt
                                            yolov5m.pt
                                            yolov5l.pt 
                                            yolov5x.pt --img 1280
```

## Filter tracked classes

By default the tracker tracks all MS COCO classes.

If you only want to track persons I recommend you to get [these weights](https://drive.google.com/file/d/1gglIwqxaH2iTvy6lZlXuAcMpd_U0GCUb/view?usp=sharing) for increased performance

```bash
python3 track.py --source 0 --yolo_weights yolov5/weights/crowdhuman_yolov5m.pt --classes 0  # tracks persons, only
```

If you want to track a subset of the MS COCO classes, add their corresponding index after the classes flag

```bash
python3 track.py --source 0 --yolo_weights yolov5s.pt --classes 16 17  # tracks cats and dogs, only
```

## MOT compliant results

Can be saved to `inference/output` by 

```bash
python3 track.py --source ... --save-txt
```

## Cite

If you find this project useful in your research, please consider cite:

```latex
@misc{yolov5deepsort2024,
    title={Real-time multi-object tracker using YOLOv5 and deep_sort},
    author={Shi Bingyi},
    howpublished = {\url{https://github.com/SBY7219/Yolov5_DeepSort_Replicate}},
    year={2024}
}
```

